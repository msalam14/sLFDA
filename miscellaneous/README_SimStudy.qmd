---
title: "Vignette for codes used for the simulation study Alam and Staicu, 20xx"
format: gfm
---

This file illustrates how to use the codes in files *utilities_generate.R*, *utilities_main.R*, *utilities_estimate.R*, *utilities_estimate_misclass.R*, and *utilities_estimate_comptime.R* to reproduce the simulation study. 

- First, load all the functions in files *utilities_generate.R* and *utilities_main.R*
```{r}
source("utilities_generate.R")
source("utilities_main.R")
```

- Note that, all the functions in files *utilities_generate.R* and *utilities_main.R* are available in *sLFDA* package. It can be installed from github via
```{r}
#| eval: false
#| warning: false
#| message: false
devtools::install_github("https://github.com/msalam14/sLFDA")
```

- Results for original simulation study and two other SNR scenarios (1.90 and 1.20) were generated by *utilities_estimate.R* script. 
<!-- Note that, though this script is capable of generating all the results shown in the original manuscrip and supplementary material, it was not executed altogether in actual implementation due to computation time. Rather, nine separate scripts correspond to the nine combinations by the skewness scenarios and sample size under a SNR value were executed separately.  -->
```{r}
#| eval: false
source("utilities_estimate.R")
```

::: callout-tip
### Note
We perform the simulation on HPC; particularly, parallel jobs were run on distributed memory. To do so, we use the *Rmpi* package in the script *utilities_estimate.R*. For every SNR, there are 9 combinations by the type of skewness scenarios and sample size ($3$ sample sizes and $3$ skewness scenarios). Each of these 9 combinations (in total 27 combinations for 3 SNR values) were executed separately. Every combination stores $6$ files that results a total of $54$ files from the 9 combinations. 
:::

- Similarly, results for simulation study on the covariance model misclassification were obtained by 

```{r}
#| eval: false
source("utilities_estimate_misclass.R")
```

- The computational times were stored by the following codes

```{r}
#| eval: false
source("utilities_estimate_comptime.R")
```

- The *R* script named as *utilities_results.R* contains all the necessary codes to summarize simulation results stored in the $(54*3)+54=216$ files by the scripts *utilities_estimate.R* and *utilities_estimate_misclass.R*. Files generated by this script were used to create the Tables and Figures reported in the original manuscript and supplementary material. 

- Simulation results for computational time were directly used to generate the plot and Table. Though, codes for generating the Figures and Tables are not shared in this repository, all the files required to generate these Figures and Tables are available in this repository.  
